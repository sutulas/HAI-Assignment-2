{"ast":null,"code":"import { Transform } from 'vega-dataflow';\nimport { inherits } from 'vega-util';\nimport { Delaunay } from 'd3-delaunay';\nfunction Voronoi(params) {\n  Transform.call(this, null, params);\n}\nVoronoi.Definition = {\n  'type': 'Voronoi',\n  'metadata': {\n    'modifies': true\n  },\n  'params': [{\n    'name': 'x',\n    'type': 'field',\n    'required': true\n  }, {\n    'name': 'y',\n    'type': 'field',\n    'required': true\n  }, {\n    'name': 'size',\n    'type': 'number',\n    'array': true,\n    'length': 2\n  }, {\n    'name': 'extent',\n    'type': 'array',\n    'array': true,\n    'length': 2,\n    'default': [[-1e5, -1e5], [1e5, 1e5]],\n    'content': {\n      'type': 'number',\n      'array': true,\n      'length': 2\n    }\n  }, {\n    'name': 'as',\n    'type': 'string',\n    'default': 'path'\n  }]\n};\nconst defaultExtent = [-1e5, -1e5, 1e5, 1e5];\ninherits(Voronoi, Transform, {\n  transform(_, pulse) {\n    const as = _.as || 'path',\n      data = pulse.source;\n\n    // nothing to do if no data\n    if (!data || !data.length) return pulse;\n\n    // configure and construct voronoi diagram\n    let s = _.size;\n    s = s ? [0, 0, s[0], s[1]] : (s = _.extent) ? [s[0][0], s[0][1], s[1][0], s[1][1]] : defaultExtent;\n    const voronoi = this.value = Delaunay.from(data, _.x, _.y).voronoi(s);\n\n    // map polygons to paths\n    for (let i = 0, n = data.length; i < n; ++i) {\n      const polygon = voronoi.cellPolygon(i);\n      data[i][as] = polygon && !isPoint(polygon) ? toPathString(polygon) : null;\n    }\n    return pulse.reflow(_.modified()).modifies(as);\n  }\n});\n\n// suppress duplicated end point vertices\nfunction toPathString(p) {\n  const x = p[0][0],\n    y = p[0][1];\n  let n = p.length - 1;\n  for (; p[n][0] === x && p[n][1] === y; --n);\n  return 'M' + p.slice(0, n + 1).join('L') + 'Z';\n}\nfunction isPoint(p) {\n  return p.length === 2 && p[0][0] === p[1][0] && p[0][1] === p[1][1];\n}\nexport { Voronoi as voronoi };","map":{"version":3,"names":["Transform","inherits","Delaunay","Voronoi","params","call","Definition","defaultExtent","transform","_","pulse","as","data","source","length","s","size","extent","voronoi","value","from","x","y","i","n","polygon","cellPolygon","isPoint","toPathString","reflow","modified","modifies","p","slice","join"],"sources":["C:/Users/sutul/node_modules/vega-voronoi/build/vega-voronoi.module.js"],"sourcesContent":["import { Transform } from 'vega-dataflow';\nimport { inherits } from 'vega-util';\nimport { Delaunay } from 'd3-delaunay';\n\nfunction Voronoi(params) {\n  Transform.call(this, null, params);\n}\nVoronoi.Definition = {\n  'type': 'Voronoi',\n  'metadata': {\n    'modifies': true\n  },\n  'params': [{\n    'name': 'x',\n    'type': 'field',\n    'required': true\n  }, {\n    'name': 'y',\n    'type': 'field',\n    'required': true\n  }, {\n    'name': 'size',\n    'type': 'number',\n    'array': true,\n    'length': 2\n  }, {\n    'name': 'extent',\n    'type': 'array',\n    'array': true,\n    'length': 2,\n    'default': [[-1e5, -1e5], [1e5, 1e5]],\n    'content': {\n      'type': 'number',\n      'array': true,\n      'length': 2\n    }\n  }, {\n    'name': 'as',\n    'type': 'string',\n    'default': 'path'\n  }]\n};\nconst defaultExtent = [-1e5, -1e5, 1e5, 1e5];\ninherits(Voronoi, Transform, {\n  transform(_, pulse) {\n    const as = _.as || 'path',\n      data = pulse.source;\n\n    // nothing to do if no data\n    if (!data || !data.length) return pulse;\n\n    // configure and construct voronoi diagram\n    let s = _.size;\n    s = s ? [0, 0, s[0], s[1]] : (s = _.extent) ? [s[0][0], s[0][1], s[1][0], s[1][1]] : defaultExtent;\n    const voronoi = this.value = Delaunay.from(data, _.x, _.y).voronoi(s);\n\n    // map polygons to paths\n    for (let i = 0, n = data.length; i < n; ++i) {\n      const polygon = voronoi.cellPolygon(i);\n      data[i][as] = polygon && !isPoint(polygon) ? toPathString(polygon) : null;\n    }\n    return pulse.reflow(_.modified()).modifies(as);\n  }\n});\n\n// suppress duplicated end point vertices\nfunction toPathString(p) {\n  const x = p[0][0],\n    y = p[0][1];\n  let n = p.length - 1;\n  for (; p[n][0] === x && p[n][1] === y; --n);\n  return 'M' + p.slice(0, n + 1).join('L') + 'Z';\n}\nfunction isPoint(p) {\n  return p.length === 2 && p[0][0] === p[1][0] && p[0][1] === p[1][1];\n}\n\nexport { Voronoi as voronoi };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}